<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>촬영 페이지</title>
  <link rel="stylesheet" href="./assets/css/style.css" />
  <link rel="stylesheet" href="./assets/css/reset.css" />
  <link rel="stylesheet" href="./assets/css/xeicon.min.css" />
  <script src="assets/js/jquery.js"></script>
</head>
<!-- 촬영 페이지 -->

<body>
  <div id="sh_adm_wrap_index">
    <!-- 관리자모드 HEADER -->
    <header>
      <div id="sh_adm_hd">
        <h1><a href="/index.html">육상 경기 운영 시스템</a></h1>
        <ul id="sh_adm_nav">
          <li>
            <a href="">
              <p>참가자관리</p>
              <i class="xi-angle-down-min"></i>
            </a>
            <ul class="nav_smn">
              <li><a href="/athlete_list.html">선수목록</a></li>
              <li><a href="/coach_list.html">코치목록</a></li>
              <li><a href="/judge_list.html">심판목록</a></li>
              <li><a href="/director_list.html">임원목록</a></li>
              <li><a href="/certificate_list.html">참가증서목록</a></li>
            </ul>
          </li>
          <li>
            <a href="">
              <p>경기관리</p>
              <i class="xi-angle-down-min"></i>
            </a>
            <ul class="nav_smn">
              <li><a href="/sports_list.html">경기목록</a></li>

              <li><a href="/schedule_list.html">일정목록</a></li>
              <li><a href="/group_list.html">조편성</a></li>
            </ul>
          </li>
          <li>
            <a href="">
              <p>기록관리</p>
              <i class="xi-angle-down-min"></i>
            </a>
            <ul class="nav_smn">
              <li><a href="/history_list.html">역대기록목록</a></li>
            </ul>
          </li>
          <li>
            <a href="">
              <p>통계관리</p>
              <i class="xi-angle-down-min"></i>
            </a>
            <ul class="nav_smn">
              <li><a href="/player_ranking_list.html">선수별 순위보기</a></li>
              <li><a href="/new_record_list.html">신기록 경기기록</a></li>
              <li><a href="/all_record.html">전체 기록보기</a></li>
              <li><a href="/schedule_medal_list.html">경기별 메달보기</a></li>
              <li>
                <a href="/country_ranking_list.html">소속별 순위보기</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="">
              <p>기록관리</p>
              <i class="xi-angle-down-min"></i>
            </a>
            <ul class="nav_smn">
              <li><a href="mypage.html">계정 정보</a></li>
              <li><a href="change_password.html">비밀번호 변경</a></li>
              <li><a href="account_write.html">계정 생성</a></li>
              <li><a href="account_list.html">계정 목록</a></li>
              <li><a href="log_list.html">로그 목록</a></li>
            </ul>
          </li>
        </ul>
        <ul id="sh_adm_gnb">
          <li id="tnb_logout">
            <a href="login.html">로그아웃</a>
          </li>
          <li class="mypage">
            <a href="mypage.html"><i class="xi-profile-o"></i></a>
          </li>
          <li>
            <button type="button" class="MobileTabMenuBtn">
              <i class="xi-bars"></i>
            </button>
          </li>
        </ul>
      </div>
      <div class="MobileTabMenu hidden">
        <!-- 관리자모드 SNB -->
        <!-- 퀵메뉴 설정 팝업 스크립트 -->
        <div class="MobileMenu">
          <div class=" ">
            <ul class="MobileMenuList">
              <li class="MobileMenuItem">
                <div class="MobileMenuTitle">
                  참가자관리
                  <i class="xi-angle-down-min"></i>
                </div>
                <ul class="MenuList" style="display: none">
                  <li><a href="/athlete_list.html">선수목록</a></li>
                  <li><a href="/coach_list.html">코치목록</a></li>
                  <li><a href="/judge_list.html">심판목록</a></li>
                  <li><a href="/director_list.html">임원목록</a></li>
                  <li><a href="/certificate_list.html">참가증서목록</a></li>
                </ul>
              </li>
              <li class="MobileMenuItem">
                <div class="MobileMenuTitle">
                  경기관리
                  <i class="xi-angle-down-min"></i>
                </div>
                <ul class="MenuList" style="display: none">
                  <li><a href="/sports_list.html">경기목록</a></li>

                  <li><a href="/schedule_list.html">일정목록</a></li>
                  <li><a href="/group_list.html">조편성</a></li>
                </ul>
              </li>
              <li class="MobileMenuItem">
                <div class="MobileMenuTitle">
                  기록관리
                  <i class="xi-angle-down-min"></i>
                </div>
                <ul class="MenuList" style="display: none">
                  <li><a href="/history_list.html">역대기록목록</a></li>
                </ul>
              </li>
              <li class="MobileMenuItem">
                <div class="MobileMenuTitle">
                  통계관리
                  <i class="xi-angle-down-min"></i>
                </div>
                <ul class="MenuList" style="display: none">
                  <li>
                    <a href="/player_ranking_list.html">선수별 순위보기</a>
                  </li>
                  <li><a href="/new_record_list.html">신기록 경기기록</a></li>
                  <li><a href="/all_record.html">전체 기록보기</a></li>
                  <li>
                    <a href="/schedule_medal_list.html">경기별 메달보기</a>
                  </li>
                  <li>
                    <a href="/country_ranking_list.html">소속별 순위보기</a>
                  </li>
                </ul>
              </li>
              <li class="MobileMenuItem">
                <div class="MobileMenuTitle">
                  기록관리
                  <i class="xi-angle-down-min"></i>
                </div>
                <ul class="MenuList" style="display: none">
                  <li><a href="mypage.html">계정 정보</a></li>
                  <li><a href="change_password.html">비밀번호 변경</a></li>
                  <li><a href="account_write.html">계정 생성</a></li>
                  <li><a href="account_list.html">계정 목록</a></li>
                  <li><a href="log_list.html">로그 목록</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="MobileBackground hidden"></div>
      <div class="top">
        <div id="js-scroll">
          <i class="xi-caret-up-min topBtn"> </i>
          <p>TOP</p>
        </div>
      </div>
    </header>
    <div id="sh_adm_cont_wrap">
      <input type="text" name="athlete_id" value="13" hidden />
      <div class="picture_wrap">
        <video id="video" style="width: 100%; height: 100%" autoplay></video>
        <button class="pictureBTN" id="capture-btn">
          <i class="xi-camera"></i>
        </button>
      </div>
    </div>
    <script>
      if (document.getElementById("video")) {
        const video = document.getElementById("video");
        const captureButton = document.getElementById("capture-btn");

        // Request access to the camera
        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then((stream) => {
            // Set the video element source to the camera stream
            video.srcObject = stream;
          })
          .catch((error) => {
            console.error("Error accessing camera:", error);
          });

        // Add click event listener to the capture button
        captureButton.addEventListener("click", async () => {
          // Create a canvas element with the same dimensions as the video stream
          const canvas = document.createElement("canvas");
          canvas.width = 1600;
          canvas.height = 1200;

          // Draw the current video frame onto the canvas
          const context = canvas.getContext("2d");
          context.drawImage(video, 0, 0, canvas.width, canvas.height);

          // Convert the canvas to a Blob object
          const blob = await new Promise((resolve) =>
            canvas.toBlob(resolve, "image/jpeg")
          );

          // var jpegFile = canvas.toDataURL("image/jpeg");

          let formData = new FormData();
          formData.append("athlete_id", "13");
          formData.append("type", "athlete");
          formData.append("athlete_profile", blob, "image.png");
          // formData.append("main_photo", jpegFile);
          fetch("action/participant/image_update.php", {
            method: "POST",
            body: formData,
          }).then((response) => {
            alert("이미지가 수정되었습니다.");
            opener.parent.location.reload();
            window.close();
          });
        });
      }
    </script>
  </div>
  <!-- #adm_cont-->
  <script src="./assets/js/main.js"></script>
</body>

</html>